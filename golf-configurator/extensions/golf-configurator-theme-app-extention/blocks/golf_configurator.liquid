<!-- Golf Configurator App Container -->
<div
  id="golf-configurator"
  data-bundle-parent-product='{{ block.settings.bundle_parent_product | json }}'
  data-shaft-products='{{ block.settings.shaft_products | json }}'
  data-variation-value='{{ product.metafields.custom.variation_value.value }}'
  data-variation-products='{{ product.metafields.custom.variation_products.value | json }}'
>
  <!-- The Preact app will be mounted here -->
  <div
    class="loading-state"
    style="padding: 2rem; text-align: center; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px;"
  >
    <p>Loading Golf Configurator...</p>
  </div>
</div>

<!-- Load Golf Configurator CSS -->
{{ 'golf-configurator.bundle.css' | asset_url | stylesheet_tag }}

<!-- Load Golf Configurator JavaScript -->
<script src="{{ 'golf-configurator.bundle.js' | asset_url }}" defer></script>

<!-- Initialize the configurator when the script loads -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // The golf configurator will auto-initialize when the bundle loads
    console.log('üèåÔ∏è Golf Configurator block loaded - Version: {{ "now" | date: "%Y%m%d-%H%M%S" }}');

    // Log metafield data for verification
    const configuratorEl = document.getElementById('golf-configurator');
    console.log('üìã Metafield Data Check:', {
      element: configuratorEl,
      variationValue: configuratorEl?.getAttribute('data-variation-value'),
      variationProducts: configuratorEl?.getAttribute('data-variation-products'),
      hasVariationData: !!(configuratorEl?.getAttribute('data-variation-value') && configuratorEl?.getAttribute('data-variation-products'))
    });
  });
</script>

{% schema %}
{
  "name": "Golf Configurator 2",
  "target": "section",
  "settings": [
    {
      "type": "product",
      "id": "bundle_parent_product",
      "label": "Bundle Parent Product",
      "info": "Select the main iron set product that will be used as the bundle parent (e.g., origin-combo-length-chrome)"
    },
    {
      "type": "product_list",
      "id": "shaft_products",
      "label": "Shaft Products",
      "info": "Select the products that should be available as shaft options in the configurator"
    }
  ]
}
{% endschema %}
